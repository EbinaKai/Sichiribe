# CLIによるカメラ映像のリアルタイム解析のやり方

カメラを接続して、ライブで解析する場合は、`live.py` を実行する。  

```bash
# 短時間解析 0.1分（6秒）のサンプル
python live.py --device 1 \
               --num-frames 10 \
               --sampling-sec 2 \
               --total-sampling-min 0.1 \
               --format csv \
               --save-frame \
               --debug
```

## 引数

| 引数 | 説明 |  
| --- | --- |  
| --device 1 | カメラデバイスの番号 |
| --num-digits 4 | 7セグメント表示器の桁数 |
| --sampling-sec 5 | 動画をサンプリングする頻度 |  
| --num-frames 10 | 一回のサンプリングで何フレーム取得するか |
| --total-sampling-min 1 | サンプリングする合計時間（分） |
| --format csv | 出力形式 (json または csv) |
| --save-frame | キャプチャしたフレームを保存するかどうか |
| --debug | ログをデバッグモードにする場合は含める |

## 処理の流れ

1. 指定された引数を元に設定を適用
2. 動画の読み込み・フレームの分割
   1. すでに分割済みのファイルがある場合は、再度分割するかの確認がされる
   2. 読み込み動画やサンプリングに関する変数等を変更した場合は再分割するを選択すると良い
3. 7セグメント表示器が写っている部分をクロップする
   1. クロップ部分を選択後、確認のウィンドウが立ち上がるが小さい場合があるので注意
   2. 確認ウィンドウがアクティブな状態で y/n のどちらかを押下する
4. クロップした部分を解析して表示内容を読み取る
5. 読み取った内容を外部ファイル等に出力する
